<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="AppleTitle" content="NAMIDI Help">
<title>NAMIDI Help</title>
<style>
code {
  display: inline-block;
  padding: 10px;
  background-color: #f8f8ff;
  border: 1px solid #ddf;
}

h2 {
  border-bottom: 1px solid #000;
}

ol.toc, ol.toc ol {
  counter-reset: item
}
ol.toc li {
  display: block
}
ol.toc li:before {
  content: counters(item, ".")" ";
  counter-increment: item
}

h1 {
  counter-reset: h2counter;
}
h2 {
  counter-reset: h3counter;
}
h2:before {
  content: counter(h2counter) "\0000a0\0000a0";
  counter-increment: h2counter;
}
h2#toc:before {
  content: none;
  counter-increment: none;
}
h3:before {
  content: counter(h2counter) "." counter(h3counter) "\0000a0\0000a0";
  counter-increment: h3counter;
}

table pre {
  margin-top: 0;
}

</style>
</head>
<body>
<img src="icon.png" width="36px" height="36px">
<h1 style="display: inline-block;">NAMIDI</h1>

<h2 id="toc">Table of Contents</h2>

<ol class="toc">
  <li>
    <a href="#about-namidi">About NAMIDI</a>
  </li>
  <li>
    <a href="#getting-started">Getting Started</a>
    <ol>
      <li>
        <a href="#initial-setup">Initial Setup</a>
      </li>
      <li>
        <a href="#hello-namidi">Hello NAMIDI</a>
      </li>
    </ol>
  </li>
  <li>
    <a href="#basics">Basics</a>
    <ol>
      <li>
        <a href="#syntax-form">Syntax Form</a>
      </li>
      <li>
        <a href="#step">Step</a>
      </li>
      <li>
        <a href="#tie-and-rest">Tie and Rest</a>
      </li>
      <li>
        <a href="#sharp-and-flat">Sharp and Flat</a>
      </li>
      <li>
        <a href="#change-sound">Change Sound</a>
      </li>
      <li>
        <a href="#using-channel">Using Channel</a>
      </li>
      <li>
        <a href="#chord">Chord</a>
      </li>
      <li>
        <a href="#polyphony">Polyphony</a>
      </li>
      <li>
        <a href="#using-velocity">Using Velocity</a>
      </li>
      <li>
        <a href="#using-gatetime">Using Gatetime</a>
      </li>
      <li>
        <a href="#octave-rule">Octave Rule</a>
      </li>
      <li>
        <a href="#tempo-change">Tempo Change</a>
      </li>
      <li>
        <a href="#time-signature">Time Signature</a>
      </li>
    </ol>
  </li>
  <li>
    <a href="#using-pattern">Using Pattern</a>
    <ol>
      <li>
        <a href="#create-pattern">Create Pattern</a>
      </li>
      <li>
        <a href="#expand-pattern">Expand Pattern</a>
      </li>
      <li>
        <a href="#extend-pattern">Extend Pattern</a>
      </li>
    </ol>
  </li>
</ol>

<h2 id="about-namidi">About NAMIDI</h2>
<p>
NAMIDI is the MIDI Player that plays DSL based music sequence.<br />
The meaning of the name NAMIDI is abbreviation for "Noriyoshi Abe's MIDI Sequencer".<br />
This is not a joke.  hehehe üòù
</p>

<h2 id="getting-started">Getting Started</h2>
<h3 id="initial-setup">Initial Setup</h3>
<i>* This step is going to be unnecessary in the future release.</i>
<p>
<ol>
  <li>IAC Driver</li>
    <ul>
      <li>Open [Audio Midi Setup] from /Application/Utilities/Audio Midi Setup.app</li>
      <li>Select [Window] -&gt; [Show MIDI Window] on the Menu</li>
      <li>Double click [IAC Driver]</li>
      <li>Tick the checkbox named "Device is online"</li>
    </ul>
  <li>Audio Units</li>
    <ul>
      <li>Download and install <a href="https://www.apple.com/jp/itunes/mastered-for-itunes/">AU Lab</a> unless it's already intalled</li>
      <li>Open the bundled file "midi.trak"</li>
    </ul>
    <br />
    <i>
      Because of AU Lab setting is kind of difficult, using "midi.trak" is recommended.
      This file is preset for DSLMusicDevice.
      If you prefer other MIDI source or customizing, see AU Lab's help contents and find out the detail.
    </i>
</ol>

<p>
Now, NAMIDI is ready to soundüòÉ
</p>

<h3 id="hello-namidi">Hello NAMIDI</h3>
<p>
NAMIDI is not a MIDI editor.  It focuses only playing and preview sequence.<br />
That is why, creating sequence file is needed first.  Don't worry.  The sequence file is quite simple.  It is just a text file with ".namidi" file extention.
</p>

<h4>hello.namidi</h4>
<pre><code>note 1/4 {
  C D E F
}
</code></pre>

<p>
The first example is that's it!<br />
Create a text file and type above snipet. Then save it with name "hello.namidi".<br />
</p>

<h4>Open with NAMIDI.app</h4>

<p>
Next, launch NAMIDI.app and open the file "hello.namidi".<br />
As usualy, just open from file menu.<br />
</p>
<p>
Now, you can see the sequence like following list.
</p>

<pre><code>   | 1               2
========================
   | .           x---.  
   | .       x---    .  
   | .               .  
   | .   x---        .  
   | .               .  
C4 | x---            .  
</code></pre>

<p>
Then, press 'p' key and you can hear melody of 'C D E F'.
</p>

<h4>Adding note to C2</h4>

<p>
Let's edit "hello.namidi" with NAMIDI stayed running.<br />
Adding 4 notes up to 1 octave.
</p>

<pre><code>note 1/4 {
  C D E F G A B C&gt;
}
</code></pre>

<p>
Once you open the .namidi file, it's not need to reopen nor reload again.<br />
When the .namidi file is edited, NAMIDI reload and rebuild sequence automatically.
</p>
<p>
Now, you can see the sequence like following list.
</p>

<pre><code>   | 1               2
========================================
C5 | .               .           x---.
   | .               .       x---    .
   | .               .               .
   | .               .   x---        .
   | .               .               .
   | .               x---            .
   | .               .               .
   | .           x---.               .
   | .       x---    .               .
   | .               .               .
   | .   x---        .               .
   | .               .               .
C4 | x---            .               .  
</code></pre>


<h2 id="basics">Basics</h2>

<h3 id="syntax-form">Syntax Form</h3>

<p>
NAMIDI ignores case of letters.<br />
And source code is free-form as long as no syntax error is contained.
</p>
<p>
Following lists are all acceptable.
<p>

<pre><code>note 1/4 {
  c d e f
}

NOTE 1/4 {
  C
  D
  E
  F
}

Note 1/4
{ C D E F }

notE // What's this?
1/4 {
  C D E F
}
</code></pre>

<p>
Text starting with "/*" is treated as a comment and ignored. The comment ends at the next "*/".<br />
After "//" to end of the line is also treated as a comment.
</p>

<pre><code>/*
  This block is ignored.
 */

note 1/4 {
  C // This is comment but C isn't
  D /* This is comment but D and E aren't */ E
  //F Hey!! I'm ignored!!
}
</code></pre>

<h3 id="step">Step</h3>

<p>
The meaning of "Step" in this context is distance between a note and next one.<br />
The ways of specifying step are following paterns.
</p>

<h4>Specify with Time Signature</h4>
<table>
  <tr>
    <td>
<pre><code>// 8 beat
note 1/8 {
  C D E F C D E F
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2
========================
   | .     x-      x-.  
   | .   x-      x-  .  
   | .               .  
   | . x-      x-    .  
   | .               .  
C4 | x-      x-      .  
</code></pre>
    </td>
  </tr>

  <tr>
    <td>
<pre><code>// Dotted quarter note
note 1/4 . {
  C D E
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2
========================
   | .               .  
   | .           x------  
   | .               .  
   | .     x-----    .  
   | .               .  
C4 | x-----          .  
</code></pre>
    </td>
  </tr>

  <tr>
    <td>
<pre><code>// Triplet
note 1/4 3 {
  C D E C D E C D E C D E
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1                       2  
================================
   | .                       .
   | .   x-    x-    x-    x-.
   | .                       .
   | . x-    x-    x-    x-  .
   | .                       .
C4 | x-    x-    x-    x-    .  
</code></pre>
    </td>
  </tr>
</table>

<p>
List of available Time Signature is here.
</p>
<ul>
  <li>1/1</li>
  <li>1/2</li>
  <li>1/4</li>
  <li>1/8</li>
  <li>1/16</li>
  <li>1/32</li>
  <li>1/64</li>
  <li>and so on.<br />
    <ul>
      <li>Beat numerator must be 1</li>
      <li>Beat denominator must be 1 or power of 2</li>
      <li>Actual step length greater than 0</li>
    </ul>
  </li>
</ul>

<h4>Specify with Integer</h4>

<table>
  <tr>
    <td>
<pre><code>/*
 * Quintuplet
 *   * Resolution of quarter note is 480
 */
note 24 {
  C D E F G
  C D E F G
  C D E F G
  C D E F G
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1                   2
============================
   | .   x    x    x    x.
   | .                   .
   | .  x    x    x    x . 
   | . x    x    x    x  .
   | .                   .
   | .x    x    x    x   .
   | .                   .
C4 | x    x    x    x    .  
</code></pre>
    </td>
  </tr>
</table>


<h3 id="tie-and-rest">Tie and Rest</h3>

<p>
"~" acts as Tie.  Tie inclements step and extends previous note.<br />
"^" acts as Rest.  Rest inclements step and does nothing.
</p>

<table>
  <tr>
    <td>
<pre><code>note 1/8 {
  C^ C^ D~ E~~~
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2
=========================
   | .           x-------
   | .               .
   | .       x---    .    
   | .               .
C4 | x-  x-          .   
</code></pre>
    </td>
  </tr>
</table>


<h3 id="sharp-and-flat">Charp and Flat</h3>

<p>
Sharp or Flat tone is simply represented by adding '#' or 'b'.
</p>

<table>
  <tr>
    <td>
<pre><code>note 1/4 {
  C# D# F# Gb Ab Bb
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2  
=============================
B  | .               .
   | .               .   x---
A  | .               .
   | .               x---
G  | .               .
   | .       x---x---.
F  | .               .
E  | .               .
   | .   x---        .
D  | .               .
   | x---            .
C4 | .               .       
</code></pre>
    </td>
  </tr>
</table>


<h3 id="change-sound">Change Sound</h3>

<p>
Instruments can be changed with "sound select" statement.
</p>

<pre><code>// Params are &lt;LSB&gt; &lt;MSB&gt; &lt;Program No&gt; from left.
sound select 0 0 27 // This means Electric Guitar (jazz)
                    // Expanded MIDI Messages are
                    //   - Bank Select&lt;MSB&gt; #0
                    //   - Bank Select&lt;LSB&gt; #0
                    //   - Program change&lt;&gt; #27

note 1/4 {
  C D E F // Play with Electric Guitar (jazz)
}

sound select 127 0 0 // This means Standard Kit of Drum sounds

note 1/4 {
  C // This produces Bass Drum 1 sound
  E // This produces Electric Snare sound
}
</code></pre>

<p>
Instruments depends on MIDI source.
See Sound Set of the MIDI source.<br />
<i>* Sound Set of DSLMusicDevice based on <a target="_blank" href="http://www.midi.org/techspecs/gm1sound.php">General MIDI Level 1 Sound Set</a></i> 
</p>

<p>
The statment changes instruments of current channel.<br />
See <a href="#using-channel">Using Channel</a>
</p>

<h3 id="using-channel">Using Channel</h3>

<p>
16 channels are supported same as General MIDI.
</p>

<table>
  <tr>
    <td>
<pre><code>channel 1

note 1/4 {
  C D E F
}

channel 10

note 1/4 {
  C C C C
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2               3
========================================
   | .           x---.               .
   | .       x---    .               .
   | .               .               .
   | .   x---        .               .
   | .               .               .
C4 | x---            +---+---+---+---.

                             x: channel 1
                             +: channel 10
</code></pre>
    </td>
  </tr>
</table>

<p>
Behavior of the channel 10 depends on MIDI source.<br />
<i>* Channel 10 on DSLMusicDevice is reserved for percussion.</i> 
</p>


<h3 id="chord">Chord</h3>

<p>
Pitch name can be joined by ','.<br />
Joined pitch names act as chord.
</p>

<table>
  <tr>
    <td>
<pre><code>note 1/2 {
  C E,G,B
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2 
========================
   | .       x-------. 
   | .               . 
   | .               . 
   | .               . 
   | .       x-------. 
   | .               . 
   | .               . 
   | .       x-------. 
   | .               . 
   | .               . 
   | .               . 
C4 | x-------        .  
</code></pre>
    </td>
  </tr>
</table>


<h3 id="polyphony">Polyphony</h3>

<p>
'note' statement also can be joined by ','.<br />
Those notes sound simultaneously from same position.
</p>

<table>
  <tr>
    <td>
<pre><code>note 1/4 { C~~~ },
note 1/4 { ^E~~ },
note 1/4 { ^^G~ },
note 1/4 { ^^^B }
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2 
========================
   | .           x---. 
   | .               . 
   | .               . 
   | .               . 
   | .       x-------. 
   | .               . 
   | .               . 
   | .   x-----------. 
   | .               . 
   | .               . 
   | .               . 
C4 | x---------------.
</code></pre>
    </td>
  </tr>
</table>


<h3 id="using-velocity">Using Velocity</h3>

<p>
Velocity can be specified 0 to 127 same as General MIDI.<br />
The default value is 100 and can be changed by 'velocity' statement.
</p>

<pre><code>velocity 127 // After this statement, note's velocity is set with 127

note 1/2 {
  C D E F // These notes sound on loud
}
</code></pre>

<p>
Velocity can be assigned temporarily with no effect on after notes.
</p>

<pre><code>velocity 127

note 1/2 {
  C(velocity=100)     // Velocity is 100
  D                   // Velocity is 127
  E,F,G(velocity=100) // Velocity of E and F are 127.  Velocity of G is 100
  A                   // Velocity is 127
}
</code></pre>


<h3 id="using-gatetime">Using Gatetime</h3>

<p>
Gatetime means how long note sustains, same as major DAW.<br />
The default is equal to step.  As discussed <a href="#tie-and-rest">previously</a>, lenght of note, it means gatetime, can be extended by 'tie'.<br />
The cases that this expression is needed are usually following 2 patterns.
</p>

<h4>Rhythm Composing</h4>

<p>
Because length of percussive note has no meaning, displaying gatetime is unnecessary.<br />
Setting fixed length of gatetime is useful for displaying percussive notes clearly.
</p>

<table>
  <tr>
    <td>
<pre><code>// No gatetime setting

note 1/8 {
  C ^ E ^ C C E ^
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2  
========================
   | .               .  
   | .   x-      x-  .  
   | .               .  
   | .               .  
   | .               .  
C4 | x-      x-x-    .  
</code></pre>
    </td>
  </tr>

  <tr>
    <td>
<pre><code>gatetime 1/16

note 1/8 {
  C ^ E ^ C C E ^
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2
========================
   | .               .   
   | .   x       x   .   
   | .               .   
   | .               .   
   | .               .   
C4 | x       x x     .
</code></pre>
    </td>
  </tr>
</table>


<h4>Cut off end of sound</h4>

<p>
Sometimes, short length of note, like staccato, is preferred depending on the instrument.<br />
However, once gatetime is set, this settings is applied until nexttime it is set.<br />
With 'cut off' modifier, gatetime can be shortened specified value by step length.
</p>

<table>
  <tr>
    <td>
<pre><code>gatetime cutoff 30

note 1/4 {
  C D E ~
},
note 1/2 {
  G G
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2 
========================
   | x------ x------ . 
   | .               . 
   | .               . 
   | .       x------ . 
   | .               . 
   | .   x--         . 
   | .               . 
C4 | x--             .
</code></pre>
    </td>
  </tr>
</table>


<h3 id="octave-rule">Octave Rule</h3>

<p>
Available note range is C-1 to G9 and the default octave is 4 according to ISO standard.<br />
Octave can be specified by 'octave' statement or inline expression as pitch name followed by octave number.<br />
These expresseion affects the octave of following notes.
</p>

<table>
  <tr>
    <td>
<pre><code>octave 2 // 'octave' statement

note 1/4 {
  C D E ~
}

note 1/4 {
  C3 D E ~  // inline expresseion
  C2 D E ~
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2               3               4
========================================================
   | .               .       x-------.               . 
   | .               .               .               . 
   | .               .   x---        .               . 
   | .               .               .               . 
C3 | .               x---            .               . 
   | .               .               .               .
   | .               .               .               .
   | .               .               .               .
   | .               .               .               .
   | .               .               .               .
   | .               .               .               .
   | .               .               .               .
   | .       x-------.               .       x-------.
   | .               .               .               .
   | .   x---        .               .   x---        .
   | .               .               .               .
C2 | x---            .               x---            .
</code></pre>
    </td>
  </tr>
</table>

<p>
Also, octave can be specified temporarily for edge of octave number.<br />
'&lt;' or '&gt;' can be added continuously up to 4 times.
</p>

<table>
  <tr>
    <td>
<pre><code>note 1/4 {
  C B&lt; G C&gt; C&gt;&gt; C

  // Hey!! This is ridiculous isn't it?
  // C&gt;&gt;&gt;&gt;&gt;
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2
===============================
C6 | .               x---
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
C5 | .           x---.
   | .               .
   | .               .
   | .               .
   | .               .
   | .       x---    .
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
   | .               .
C4 | x---            .   x---
   |     x---        .
</code></pre>
    </td>
  </tr>
</table>


<h3 id="tempo-change">Tempo Change</h3>

<p>
Available tempo range is 30.0 to 300.0 .<br />
The default is 120.0
</p>

<pre><code>tempo 60

note 1/4 {
  C D E F
}

tempo 180.55 // Speeding up from here.
             // Can be specified with the second decimal place.

note 1/4 {
  C D E F
}

tempo 300 // Hey!! Too fast!!
</code></pre>

<h3 id="time-signature">Time Signature</h3>

<p>
Time signature is expressed with numerator, slash and denominator.<br />
Numerator range is 1 to 64.<br />
Denominator range is 1 to 64 and must be power of 2 unless it is 1.<br />
The default is 4/4.
</p>

<table>
  <tr>
    <td>
<pre><code>time 3/4

note 1/4 {
  C D E
}
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1           2 
====================
   | .       x---. 
   | .           . 
   | .   x---    . 
   | .           . 
C4 | x---        .
</code></pre>
    </td>
  </tr>
</table>

<p>
Time signature affects displaying line of measures and <a href="#locaton-expresseion">'location' expression.</a><br />
</p>


<h2 id="using-pattern">Using Pattern</h2>

<p>
As composing more complex song, duplicated code increase if there is only 'note' statement that expresses sequence.
And duplicated codes make it more difficult to maintenance.<br />
The 'pattern' statement is for reducing repetition and make codes reusable. <br />
</p>

<h3 id="create-pattern">Create Pattern</h3>

<p>
Pattern is constructed by some of basic statements and assigned to user-defined identifier.
</p>

<pre id="i_am_a_8beat_pattern"><code>i_am_a_8beat_pattern = {
  channel 10
  octave 2
  velocity 127
  gatetime 100

  note 1/8 {
    F# F# F# F# F# F# F# F#
  },
  note 1/4 {
    ^     E     ^     E
  },
  note 1/8 {
    C  ^  ^  ^  C  C  ^  ^
  }
}
</code></pre>

<h4>Available Statements</h4>
<ul>
  <li>note</li>
  <li>channel</li>
  <li>velocity</li>
  <li>gatetime</li>
  <li>octave</li>
  <li>sound select</li>
  <li>time</li>
  <li>tempo</li>
  <li>marker * Unimplemented</li>
  <li>pattern</li>
</ul>

<h4>Reqirements of User-defined Identifier</h4>

<ul>
  <li>Accepted characters are alphabet, number and underscore</li>
  <li>Not equal to statement keywords</li>
  <li>Start with alphabet or underscore</li>
</ul>

<h4>Precautions</h4>

<ul>
  <li>Only the identifier that is defined on previous source code is visible</li>
  <li>Can be define same identifier but it is overwritten</li>
  <li>Nested pattern is visible only inside of the pattern to define it</li>
  <li>The default values of followings is inherited from the context to define pattern</li>
  <ul>
    <li>channel</li>
    <li>velocity</li>
    <li>gatetime</li>
    <li>octave</li>
    <li>time signature</li>
  </ul>
</ul>

<h3 id="expand-pattern">Expand Pattern</h3>

<p>
After pattern is created, it can be expanded with User-defined Identifier.<br />
<i>* In this section, "i_am_a_8beat_pattern" <a href="#i_am_a_8beat_pattern">listed above</a> is already defined.</i>
</p>

<table>
  <tr>
    <td>
<pre><code>i_am_a_8beat_pattern
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2 
========================
   | .               . 
   | .               . 
   | .               . 
   | x x x x x x x x . 
   | .               . 
   | .   x       x   . 
   | .               . 
   | .               . 
   | .               . 
C2 | x       x x     .
</code></pre>
    </td>
  </tr>
</table>

<p>
New pattern can be defined with expanding of the other pattern.
</p>

<table>
  <tr>
    <td>
<pre><code>_8beat_4times = {
  i_am_a_8beat_pattern
  i_am_a_8beat_pattern
  i_am_a_8beat_pattern
  i_am_a_8beat_pattern
}

_8beat_4times
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2               3               4
========================================================================
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x . 
   | .               .               .               .               . 
   | .   x       x   .   x       x   .   x       x   .   x       x   . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
C2 | x       x x     x       x x     x       x x     x       x x     .
</code></pre>
    </td>
  </tr>
</table>

<p>
Like 'note' statement, user-defined identifier also can be joined by ','.<br />
It acts as expanding patterns simultaneously.
</p>

<table>
  <tr>
    <td>
<pre><code>diatonic_chords = {
  channel 1
  octave 3
  velocity 127
  gatetime cutoff 10

  note 1/2 {
    C,E,G
    D,F,A
    E,G,B
    F,A,C
    G,B,D
    A,C,E
    B,D,F
    C,E,G
  }
}

_8beat_4times, diatonic_chords
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2               3               4
========================================================================
   | .               x-------        x-------        x-------        . 
   | .               .               .               .               . 
   | .       x-------.       x-------.       x-------.               . 
   | .               .               .               .               . 
   | x-------        x-------        x-------        .       x-------. 
   | .               .               .               .               . 
   | .       x-------.       x-------.               x-------        . 
   | x-------        x-------        .       x-------.       x-------. 
   | .               .               .               .               . 
   | .       x-------.               x-------        x-------        . 
   | .               .               .               .               . 
C3 | x-------        .       x-------.       x-------.       x-------. 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + . 
   | .               .               .               .               . 
   | .   +       +   .   +       +   .   +       +   .   +       +   . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
C2 | +       + +     +       + +     +       + +     +       + +     .

                                                            x: channel 1
                                                            +: channel 10
</code></pre>
    </td>
  </tr>
</table>


<h3 id="extend-pattern">Extend Pattern</h3>

<p>
Typically, musical composition is composed by several key sections and these variations.<br />
"Extend Pattern" expresseion is for create the variations easily.
</p>

<table>
  <tr>
    <td>
<pre><code>channel 10
octave 2
velocity 127
gatetime 100

_8beat = {
  note 1/8 {
    F# F# F# F# F# F# F# F#
  },
  note 1/4 {
    ^     E     ^     E
  },
  note 1/8 {
    C  ^  ^  ^  C  C  ^  ^
  }
}

_8beat_4times = {
  _8beat
  _8beat
  _8beat
  _8beat
}

_8beat_4times_with_fill_in = _8beat_4times {
  replace from 0 to 240 {
    note 1/8 {
      C, C#&gt;
    }
  }

  mix from 4:4:240 {
    note 1/8 {
      E
    }
  }
}

_8beat_4times_with_fill_in
</code></pre>
    </td>
    <td>
      &nbsp;&nbsp;&nbsp;&nbsp; -&gt; &nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td>
<pre><code>   | 1               2               3               4
========================================================================
   | x               .               .               .               .  &lt;- Crash cymbal
C3 | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
   | . x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x . 
   | .               .               .               .               . 
   | .   x       x   .   x       x   .   x       x   .   x       x x .  &lt;- Mixed last snare drum
   | .               .               .               .               . 
   | .               .               .               .               . 
   | .               .               .               .               . 
C2 | x       x x     x       x x     x       x x     x       x x     .
</code></pre>
    </td>
  </tr>
</table>

<p>
Example listed above extends "_8beat_4times" and assigns it to new pattern with "_8beat_4times_with_fill_in" identifier.<br />
If "_8beat_4times_with_fill_in" is not need to reuse, it can be extended and expanded directly.
</p>

<pre><code>// This acts extending and expanding
_8beat_4times {
  replace from 0 to 240 {
    note 1/8 {
      C, C#&gt;
    }
  }

  mix from 4:4:240 {
    note 1/8 {
      E
    }
  }
}
</code></pre>

<h4>Replace Block</h4>
<p>
As listed above, it repalces some range of pattern.<br />
If pattern contains multiple channels, notes that removed can be limited with specified channel.
</p>

<pre><code>
example = {
  channel 1
  notes {
    ...
  }

  channel 2
  notes {
    ...
  }
}

example {
  replace channel 1 {
    ...
  }
}
</code></pre>

<h4>Mix Block</h4>
<p>
As listed above, it simply adds notes from specified position without removing.
</p>

<h4 id="locaton-expresseion">Location Expression</h4>

<p>
The range of replace or mix block is specified by 'from' and 'to' modifier with absolute step number or 'location' expresseion.<br />
Following lists are variations of location pattterns.<br />
<i>* 4/4 with Resolution 480</i>
</p>

<table>
  <tr>
    <th>Expression</th>
    <th>Step value</th>
    <th></th>
  </tr>
  <tr>
    <td>1:1:0</td>
    <td>0</td>
    <td></td>
  </tr>
  <tr>
    <td>2:1:0</td>
    <td>1920</td>
    <td></td>
  </tr>
  <tr>
    <td>1:2:0</td>
    <td>480</td>
    <td></td>
  </tr>
  <tr>
    <td>1:2:240</td>
    <td>720</td>
    <td></td>
  </tr>
  <tr>
    <td>2:240</td>
    <td>720</td>
    <td><i>* Measure no can be ommited</i></td>
  </tr>
  <tr>
    <td>2m</td>
    <td>1920</td>
    <td><i>* Meaning is measure 2</i></td>
  </tr>
  <tr>
    <td>2b</td>
    <td>480</td>
    <td><i>* Meaning is beat 2</i></td>
  </tr>
</table>
